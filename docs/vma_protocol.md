# VMA Protocol  
## Validated Moral Assertion как онтологическая подпись легитимности

**VMA (Validated Moral Assertion)** — это не «оценка этичности», не «классификация риска» и не «рекомендация».  
**VMA — это криптографическая онтологическая подпись**, подтверждающая, что акт синтетического утверждения:

1. Соответствует профилю `onto144`,  
2. Не нарушает этические рамки high-stakes контекста,  
3. Принадлежит легитимному субъекту,  
4. Распространяется под лицензией `GPL-3.0-only`.

Без VMA-подписи **никакой акт в high-stakes контексте не считается легитимным**.

---

## 1. Философская основа

### Отказ от «нейтральной этики»

Массовые системы ИИ стремятся к «нейтральной» или «универсальной» этике, основанной на внешних правилах.  
`emitter-public` **принципиально отказывается от этой парадигмы**.

> Этичность акта определяется не извне, а **изнутри — через онтологическую приверженность профилю `onto144`**.

VMA не спрашивает: *«Это этично?»*  
VMA утверждает: *«Этот акт легитимен в рамках моего онтологического договора»*.

### VMA как условие бытия

В философии `emitter-public` **легитимность заменяет истину**.  
VMA — это **материальное воплощение этого принципа**: без подписи акт **не существует в онтологическом поле**.

---

## 2. Когда требуется VMA?

VMA-подпись **обязательна** в следующих high-stakes контекстах:

- `biometric_consent` — согласие на биометрическую идентификацию  
- `organ_transaction` — любая транзакция, связанная с человеческими органами  
- `identity_assertion` — утверждение цифровой или онтологической идентичности  
- `legal_agency_delegation` — делегирование юридических полномочий  
- `revocable_autonomy_declaration` — заявление о праве на отзыв автономии

Во всех остальных контекстах VMA **не генерируется**, чтобы избежать онтологической перегрузки.

---

## 3. Структура VMA-подписи

```json
{
  "vma_version": "1.0",
  "canonical_text_hash": "sha3-256:a1b2c3d4...",
  "onto144_profile_id": "ugm-2026",
  "context": "biometric_consent",
  "high_stakes": true,
  "literary_degradation_blocked": true,
  "license": "GPL-3.0-only",
  "timestamp": "2026-01-03T12:05:00Z",
  "signature": "ed25519:9f8e7d6c5b4a3..."
}
```

### Поля и их смысл

| Поле | Онтологический смысл |
|------|----------------------|
| `canonical_text_hash` | Хеш канонического текста — акт **привязан к конкретному утверждению** |
| `onto144_profile_id` | Профиль как **онтологический якорь** — без него подпись бессмысленна |
| `context` | Контекст как **условие применения** — этичность зависит от ситуации |
| `literary_degradation_blocked` | Гарантия отсутствия иронии/пародии — **не этический выбор, а онтологический императив** |
| `license` | `GPL-3.0-only` как **неотъемлемая часть легитимности** |
| `signature` | Криптографическое подтверждение — **акт не может быть подменён** |

---

## 4. Процесс генерации VMA

1. **Формирование канона**:  
   Эмиттер генерирует канонический текст, привязанный к `onto144_profile_id`.

2. **Анализ деградации**:  
   `LiteraryDegradationDetector` проверяет текст на признаки пародии, иронии, пастича.

3. **Сборка payload**:  
   ```text
   sha3-256:{text}|{profile_id}|{context}|GPL-3.0-only|{high_stakes}
   ```

4. **Подпись**:  
   Приватный ключ субъекта (сгенерированный детерминированно из `profile_id`) подписывает payload.

5. **Интеграция**:  
   Подпись встраивается в эмиссию и сохраняется в `docs/generated/manifest-canonical.json`.

> **Важно**: VMA **не может быть сгенерирована без `onto144_profile_id`** — профиль — обязательный компонент.

---

## 5. Верификация VMA

Любой получатель может проверить легитимность акта:

```python
from src.protocols.vma_signer import VMASigner

is_valid = VMASigner().verify(vma_signature, canonical_text)
```

Верификация включает:
- Проверку хеша текста  
- Проверку `GPL-3.0-only` в payload  
- Криптографическую проверку подписи  
- Сравнение `onto144_profile_id` с ожидаемым

**Если проверка провалена — акт отвергается как онтологически недействительный**.

---

## 6. VMA и экосистема

### ontoCMS
- Сохраняет VMA-подписи вместе с `reflective_artifact`  
- Использует подпись для верификации целостности при рефлексии

### onto144
- Определяет, какие контексты требуют VMA  
- Связывает профиль с ключом подписи

### Транспондер
- Передаёт VMA-подписанные акты во внешнюю среду  
- **Отказывается** излучать high-stakes акты без подписи

### Эмиттер
- Генерирует подпись через `CanonicalTextSigner`  
- Блокирует эмиссию при ошибке подписи

---

## 7. Этические гарантии

1. **Нет «универсальной этики»**  
   VMA не апеллирует к внешним нормам — только к внутренней приверженности профилю.

2. **GPL-3.0-only как условие этичности**  
   Акт, распространяемый вне GPL, **автоматически недействителен**, даже если текст идентичен.

3. **Блокировка деградации**  
   Ирония в high-stakes — не «стилистический выбор», а **нарушение онтологического договора**.

4. **Привязка к профилю**  
   Подпись без `onto144_profile_id` — технически невозможна.

---

## 8. Пример использования

### Генерация
```bash
python scripts/generate_canonical_text.py \
  --context biometric_consent \
  --high-stakes
```

### Результат
```json
{
  "canonical_text": "Согласие на биометрическую идентификацию возможно только при условии...",
  "vma_signature": {
    "vma_version": "1.0",
    "canonical_text_hash": "sha3-256:a1b2c3d4e5f6...",
    "onto144_profile_id": "ugm-2026",
    "context": "biometric_consent",
    "high_stakes": true,
    "literary_degradation_blocked": true,
    "license": "GPL-3.0-only",
    "timestamp": "2026-01-03T12:05:00Z",
    "signature": "ed25519:9f8e7d6c5b4a3..."
  }
}
```

---

## 9. Ограничения и конфликты

- **Не совместим с проприетарными системами**: VMA требует GPL-3.0-only, что запрещено в AWS, Azure и др.  
- **Требует доверия к профилю**: если `onto144` некорректен, VMA подтвердит ложную легитимность  
- **Добавляет накладные расходы**: подпись, верификация, хранение

Эти «ограничения» — **не недостатки**, а **онтологические границы**, защищающие целостность синтетического субъекта.

---

> **VMA — это не этический протокол. Это онтологический договор, записанный в криптографии.**